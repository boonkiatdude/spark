<!DOCTYPE html>
<!-- saved from url=(0109)https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122471 -->
<html lang="en"><link type="text/css" rel="stylesheet" id="dark-mode-custom-link"><link type="text/css" rel="stylesheet" id="dark-mode-general-link"><style lang="en" type="text/css" id="dark-mode-custom-style"></style><style lang="en" type="text/css" id="dark-mode-native-style"></style><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css">
.anticon {
  display: inline-block;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
</style><meta name="google" content="notranslate"><meta http-equiv="Content-Language" content="en"><title>nlp - Databricks Community Edition</title><link rel="preload" href="https://community.cloud.databricks.com/pub-conf" as="fetch" crossorigin=""><link rel="preload" href="https://community.cloud.databricks.com/workspaces" as="fetch" crossorigin=""><link rel="icon" href="https://community.cloud.databricks.com/favicon.ico"><link rel="stylesheet" type="text/css" href="./nlp - Databricks Community Edition_files/65.239e4f12.chunk.css"><link rel="stylesheet" type="text/css" href="./nlp - Databricks Community Edition_files/498.581dc0a4.chunk.css"><link rel="stylesheet" type="text/css" href="./nlp - Databricks Community Edition_files/540.3782bbfa.chunk.css"><style data-emotion=""></style><style type="text/css">
  .g6-component-contextmenu {
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 10px 8px;
    box-shadow: rgb(174, 174, 174) 0px 0px 10px;
  }
  .g6-contextmenu-ul {
    padding: 0;
    margin: 0;
    list-style: none;
  }


  .g6-component-toolbar {
    position: absolute;
    list-style-type: none;
    padding: 6px;
    left: 0px;
    top: 0px;
    background-color: rgba(255, 255, 255, 0.9);
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    margin: 0;
  }
  .g6-component-toolbar li {
    float: left;
    text-align: center;
    width: 35px;
    height: 24px;
    cursor: pointer;
		list-style-type:none;
    list-style: none;
    margin-left: 0px;
  }
  .g6-component-toolbar li .icon {
    opacity: 0.7;
  }
  .g6-component-toolbar li .icon:hover {
    opacity: 1;
  }

  .g6-component-tooltip {
    border: 1px solid #e2e2e2;
    border-radius: 4px;
    font-size: 12px;
    color: #545454;
    background-color: rgba(255, 255, 255, 0.9);
    padding: 10px 8px;
    box-shadow: rgb(174, 174, 174) 0px 0px 10px;
  }
  .tooltip-type {
    padding: 0;
    margin: 0;
  }
  .tooltip-id {
    color: #531dab;
  }
</style><style id="plotly.js-style-global"></style><style data-emotion="css"></style><style id="detectElementResize" type="text/css">@keyframes resizeanim { from { opacity: 0; } to { opacity: 0; } } .resize-triggers { animation: 1ms resizeanim; visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }</style></head><body class="dark-mode notebook-present"><noscript>You need to enable JavaScript to run this app.</noscript><uses-legacy-bootstrap data-wrapped-element-id="toolbar"><div id="toolbar"></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="tooltip"><div id="tooltip" class="hidden"><p><span id="value"></span></p></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="global-notification-container"><div id="global-notification-container"><div class="databricks-notification-wrapper"><div class="notifications-wrapper"></div></div></div></uses-legacy-bootstrap><div id="rmmodal-container"></div><uses-legacy-bootstrap data-wrapped-element-id="topbar"><div id="topbar" style=""><div id="tb-action-banner-container"></div><h1 class="tb-title-wrapper tb-title-wrapper-central" style="left: 76px;"><span class="tb-title"><span class="notebook-title-wrapper"><span id="nbTitle">nlp</span></span></span> <span class="tb-title-portal"></span> <span class="tb-title-lang" data-lang="none"><a class="tb-lang-link" data-lang="python">(Python)</a></span><div class="tb-status"><span class="tb-status-msg tb-status-msg-error"></span> <span class="tb-status-msg tb-status-msg-banner"></span> <span class="tb-status-msg tb-status-msg-locked"></span> <span class="tb-status-msg tb-status-msg-connecting">Connecting...&nbsp;</span> <span class="tb-status-msg tb-status-msg-waiting">Still working...&nbsp;</span> <img class="tb-status-spinner" src="./nlp - Databricks Community Edition_files/spinner.gif" alt="spinner"></div></h1><a class="tb-button tb-button-right tb-button-user" title="Account" tabindex="0" role="button" aria-label="Click to open Account Menu"><i class="fa fa-user fa-lg no-workspace-name-icon" aria-hidden="true"></i><div class="workspace-name-icon-wrapper hidden btn"><span class="workspace-name"></span> <i class="fa fa-user fa-lg" aria-hidden="true"></i></div></a><a class="tb-button tb-button-right tb-button-help" title="Help and Support" tabindex="0" role="button" aria-label="Click to open Help and Support menu"><i class="fa fa-question fa-lg" aria-hidden="true"></i> </a><a class="tb-button tb-button-right tb-button-upgrade" title="Upgrade" target="_blank" href="https://accounts.cloud.databricks.com/login?utm_source=databricks&amp;utm_medium=ce_banner&amp;utm_campaign=ce_upgrade_banner&amp;utm_content=upgrade_button" style="display: none;"><span>Upgrade</span></a><div class="tb-title-wrapper tb-title-wrapper-right"><div class="tb-trial-msg"></div><div class="tb-title-icons tb-title-icons-right"></div><div class="tb-status presence"><span class="tb-status-msg tb-status-presence" style=""><!-- presenceTemplate -->

<ul class="noselect">
  
  <li title="Recent Activity" class="presence-history" role="button" aria-label="Click to view Recent Activity">
    <div><i class="fa fa-clock-o" aria-hidden="true"></i></div>
  </li>
</ul>

</span></div></div></div></uses-legacy-bootstrap><div id="sidebar-and-notebook"><uses-legacy-bootstrap data-wrapped-element-id="sidebar"><div id="sidebar" class="sidebar"><div class="sidebar-outer sidebar--theme-unified"><div class="sidebar-main" data-panel="Workspace" data-test-id="main-sidebar"><ul class="sidebar-ul"><li class="sidebar-element-wrapper sidebar-element-wrapper--logo"><a href="https://community.cloud.databricks.com/?o=6274805106266908#" class="sidebar-element" data-name="Databricks"><div class="sidebar-element-icon"><div class="sidebar-databricks-logo"><span class="svg-icon-wrapper css-v60x2c"><svg viewBox="0 0 105 113"><path d="M0 29.44v3.4l52.13 29.41 46.56-26.29.01 10.62-46.57 26.46L2.62 44.91 0 46.37v20.35l52.13 29.34 46.56-26.2.01 10.54-46.57 26.46L2.62 78.73 0 80.19v3.45l52.13 29.33 52.13-29.33V63.27l-2.63-1.45-49.5 28.13L5.56 63.49V53l46.57 26.17 52.13-29.34V29.76l-2.63-1.46-49.5 28.14L7.95 31.33 52.13 6.38l36.39 20.56 3.18-1.79v-2.8L52.13 0z" fill="currentColor" fill-rule="nonzero"></path></svg></span></div></div></a></li><li class="sidebar-element-wrapper"><a class="sidebar-element" data-name="Home"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><span class="svg-icon-wrapper css-v60x2c"><svg viewBox="0 0 20 22" fill="none"><path d="M10 1.757l8.611 6.694V20.14h-4.583v-8.903H5.972v8.903H1.39V8.459L10 1.756zM10 0L0 7.778v13.75h7.361v-8.903h5.278v8.903H20V7.778L10 0z" fill="currentColor"></path></svg></span></div></div><div><span class="sidebar-label">Home</span></div></a></li><li class="sidebar-element-wrapper"><a class="sidebar-element selected" data-name="Workspace"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><span class="svg-icon-wrapper css-v60x2c"><svg viewBox="0 0 32 32"><path fill="currentColor" d="M28.818 2.21c.541 0 .972.442.972.972v25.47a.974.974 0 01-.972.972H5.558V2.21h23.26zm0-2.21H3.348v31.834h25.47A3.182 3.182 0 0032 28.652V3.182A3.182 3.182 0 0028.818 0z"></path><path fill="none" stroke="currentColor" stroke-width="2.4" d="M10.287 0v31.823"></path><path fill="none" stroke="currentColor" stroke-width="3.2" d="M0 7.293h10.287M0 23.856h10.287M0 15.58h10.287"></path></svg></span></div></div><div><span class="sidebar-label">Workspace</span></div></a></li><li class="sidebar-element-wrapper"><a class="sidebar-element" data-name="Recents"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><span class="svg-icon-wrapper css-v60x2c"><svg viewBox="0 0 34 32"><path fill="currentColor" d="M16.821 2c7.618 0 13.816 6.28 13.816 14S24.44 30 16.821 30C9.203 30 3.005 23.72 3.005 16S9.202 2 16.821 2zm0-2C8.097 0 1.032 7.16 1.032 16s7.066 16 15.789 16c8.724 0 15.79-7.16 15.79-16S25.545 0 16.821 0z"></path><path stroke="currentColor" stroke-width="2.4" d="M16.821 6.4V16l6.316 3.2"></path></svg></span></div></div><div><span class="sidebar-label">Recents</span></div></a></li><li class="sidebar-element-wrapper"><a class="sidebar-element" data-name="Tables"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><span class="svg-icon-wrapper css-v60x2c"><svg viewBox="0 0 20 20" fill="none"><path d="M4.323 0a4.323 4.323 0 100 8.646 4.323 4.323 0 000-8.646zm0 7.355A3.029 3.029 0 011.29 4.323 3.029 3.029 0 014.323 1.29a3.029 3.029 0 013.032 3.033 3.029 3.029 0 01-3.032 3.032zM19.29.13h-8.387v8.322h8.323V.129h.064zM18 7.225h-5.742V1.484H18v5.742zM15.097 10.774L10.258 20H20l-4.903-9.226zm0 2.774l2.71 5.162h-5.484l2.774-5.162zM7.742 11.29l-3.42 3.42-3.354-3.42-.968.904 3.42 3.419L0 19.033l.968.902 3.355-3.419 3.419 3.42.903-.904-3.42-3.42 3.42-3.418-.903-.904z" fill="currentColor"></path></svg></span></div></div><div><span class="sidebar-label">Data</span></div></a></li><li class="sidebar-element-wrapper"><a href="https://community.cloud.databricks.com/?o=6274805106266908#setting/clusters" class="sidebar-element" data-name="Clusters"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><span class="svg-icon-wrapper css-v60x2c"><svg viewBox="0 0 33 32"><path fill="none" stroke-width="2.182" stroke="currentColor" d="M16.728 13.603v10.188M5.712 23.606V20.73c0-1.443 1.155-2.613 2.578-2.613h16.876c1.424 0 2.579 1.17 2.579 2.613v2.876"></path><path fill="none" stroke-linejoin="round" stroke-linecap="round" stroke-width="2.182" stroke="currentColor" d="M2.845 16.459a4.513 4.513 0 01-.471-2.028c0-2.554 2.049-4.631 4.57-4.631h1.453c.01-4.612 3.695-8.346 8.245-8.346 3.57 0 6.6 2.291 7.764 5.509h1.52c1.684 0 3.262.829 4.224 2.213a5.277 5.277 0 01-.414 6.513"></path><path fill="none" stroke-width="2.182" stroke="currentColor" d="M5.713 30.459c1.817 0 3.291-1.493 3.291-3.334s-1.473-3.334-3.291-3.334-3.29 1.493-3.29 3.334 1.473 3.334 3.29 3.334zM16.728 30.459c1.817 0 3.29-1.493 3.29-3.334s-1.473-3.334-3.29-3.334-3.291 1.493-3.291 3.334 1.473 3.334 3.291 3.334zM27.754 30.459c1.817 0 3.29-1.493 3.29-3.334s-1.473-3.334-3.29-3.334-3.291 1.493-3.291 3.334 1.473 3.334 3.291 3.334z"></path></svg></span></div></div><div><span class="sidebar-label">Clusters</span></div></a></li><li class="sidebar-element-wrapper"><a href="https://community.cloud.databricks.com/?o=6274805106266908#joblist" class="sidebar-element" data-name="Jobs"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><span class="svg-icon-wrapper css-v60x2c"><svg viewBox="0 0 39 32"><path fill="none" stroke-width="3.556" stroke="currentColor" d="M15.934 5.586h22.078M15.934 17.814h22.078M3.372 30.031h34.64M11.854 1.778L6.085 7.624 2.924 4.421M11.854 14.006l-5.769 5.846-3.161-3.203"></path></svg></span></div></div><div><span class="sidebar-label">Jobs</span></div></a></li><li class="sidebar-element-wrapper"><a class="sidebar-element" data-name="Search"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><span class="svg-icon-wrapper css-v60x2c"><svg viewBox="0 0 34 32"><path fill="currentColor" d="M14.051 1.862c6.194 0 11.231 5.104 11.231 11.381s-5.037 11.38-11.231 11.38S2.82 19.519 2.82 13.243 7.857 1.862 14.051 1.862zm0-1.862C6.836 0 .982 5.932.982 13.243s5.854 13.243 13.069 13.243c7.215 0 13.069-5.932 13.069-13.243S21.266 0 14.051 0z"></path><path fill="none" stroke="currentColor" stroke-width="3.048" d="M31.058 30.486l-8.217-8.336"></path></svg></span></div></div><div><span class="sidebar-label">Search</span></div></a></li></ul></div><div class="sidebar-alt"><div></div><div></div></div></div></div></uses-legacy-bootstrap><div id="overallView" style="left: 76px;" class="new-notebook"><div style="height: 100%;"><uses-legacy-bootstrap data-wrapped-element-id="ReactNotebookView"><div class="databricks-notification-wrapper"><div class="notifications-wrapper"></div></div><div class="new-notebook context-bar" id="context-bar"><div class="context-bar__left"><div class="attach-cluster-select-wrapper"><i class="fa fa-sitemap" style="text-align: center;"></i><div class="control-field clusters attach-cluster-select css-wwrqjh-container"><div class="react-select__control css-zapze6-control"><div class="react-select__value-container react-select__value-container--has-value css-12n3d9a"><span class="css-101qbrj-singleValue single-value single-value--with-icon"><i class="fa fa-circle fa-fw status-indicator-icon ok " style="text-align: center;"></i>my-cluster</span><div class="css-1kdqmo9"><div class="react-select__input" style="display: inline-block;"><input autocapitalize="none" autocomplete="off" autocorrect="off" id="react-select-28-input" spellcheck="false" tabindex="0" type="text" aria-autocomplete="list" aria-label="Select Cluster" value="" style="box-sizing: content-box; width: 2px; background: 0px center; border: 0px; font-size: inherit; opacity: 1; outline: 0px; padding: 0px; color: inherit;"><div style="position: absolute; top: 0px; left: 0px; visibility: hidden; height: 0px; overflow: scroll; white-space: pre; font-size: 13px; font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-weight: 400; font-style: normal; letter-spacing: normal; text-transform: none;"></div></div></div></div><div class="react-select__indicators css-1wy0on6"><span class="react-select__indicator-separator css-1okebmr-indicatorSeparator"></span><div aria-hidden="true" class="react-select__indicator react-select__dropdown-indicator css-1kh17bq-indicatorContainer"><svg height="20" width="20" viewBox="0 0 20 20" aria-hidden="true" focusable="false" class="css-19bqh2r"><path d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"></path></svg></div></div></div></div></div><div class="dropdown actions-dropdown"><div class="highlight-inactive"><a class="context-bar-item" id="actions-dropdown-link" data-name="File" role="button"><i aria-hidden="true" class="fa fa-file-text-o contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">File</span> <i aria-hidden="true" class="fa fa-caret-down caretDown--js" style="text-align: center;"></i></a></div></div><div class="dropdown edit-dropdown"><div class="highlight-inactive"><a class="context-bar-item" id="edit-dropdown-link" data-name="Edit" role="button"><i aria-hidden="true" class="fa fa-edit contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Edit</span> <i aria-hidden="true" class="fa fa-caret-down caretDown--js" style="text-align: center;"></i></a></div></div><div class="dropdown view-dropdown"><div class="highlight-inactive"><a class="context-bar-item" id="view-mode-link" data-name="View: Standard" role="button"><i aria-hidden="true" class="fa fa-picture-o contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">View: Standard</span> <i aria-hidden="true" class="fa fa-caret-down caretDown--js" style="text-align: center;"></i></a></div></div><div class="highlight-inactive"><a class="no-click context-bar-item permissions" id="share" data-name="Permissions" disabled="" role="button"><i aria-hidden="true" class="fa fa-lock contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Permissions</span></a></div><div class="highlight-inactive"><a class="context-bar-item" id="0.15538961374834415" data-name="Run All" role="button"><i aria-hidden="true" class="fa fa-play-circle-o contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Run All</span></a></div><div class="dropdown clear-dropdown"><div class="highlight-inactive"><a class="context-bar-item" id="clear-results-link" data-name="Clear" role="button"><i aria-hidden="true" class="fa fa-eraser contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Clear</span> <i aria-hidden="true" class="fa fa-caret-down caretDown--js" style="text-align: center;"></i></a></div></div></div><div class="context-bar__right"><div class="context-bar-right-links"><div id="shortcut-wrapper"><a class="shortcut-menu-icon" title="Open keyboard shortcuts reference dial" role="button"><i aria-hidden="true" class="fa fa-keyboard-o" style="text-align: center;"></i></a></div><div class="highlight-inactive"><a class="context-bar-item" id="publish-notebook" data-name="Publish" role="button"><i aria-hidden="true" class="fa fa-share-square-o contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Publish</span></a></div><div class="highlight-inactive"><a class="context-bar-item" id="show-comments" data-name="Comments" role="button"><i aria-hidden="true" class="fa fa-comments contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Comments</span></a></div><div class="highlight-inactive"><a class="context-bar-item" id="view-mlflow-runs" data-name="Experiment" role="button"><span><span><i class="fa fa-flask contextBarIcon--js" style="text-align: center;"></i></span></span><span class="context-bar-link-text">Experiment</span></a></div><div class="highlight-inactive"><a class="context-bar-item" id="show-history" data-name="Revision history" role="button"><i aria-hidden="true" class="fa fa-history contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Revision history</span></a></div></div></div></div><div id="notebook-input-widget-panel" class="input-widget-panel empty"><ul></ul><div class="widget-panel-settings"><i class="fa fa-cog settings" style="cursor: pointer; text-align: center;"></i><i class="fa fa-thumb-tack pinning pinned" style="cursor: pointer; text-align: center;"></i></div></div><div id="content" class="new-notebook" style="top: 26px;"><section class="ant-layout ant-layout-has-sider notebook-view" style="height: 100%; background-color: var(--primary-background-color);"><aside class="notebook-table-of-contents-sidebar ant-layout-sider ant-layout-sider-light ant-layout-sider-collapsed ant-layout-sider-zero-width" style="flex: 0 0 0px; max-width: 0px; min-width: 0px; width: 0px;"><div class="ant-layout-sider-children"><div class="notebook-table-of-contents-empty-text"><p>A table of contents will be added here when a notebook has Markdown headings.</p><code>%md # Heading 1</code><br></div></div><span class="ant-layout-sider-zero-width-trigger ant-layout-sider-zero-width-trigger-left"><i class="fa fa-angle-right" style="text-align: center;"></i></span></aside><main class="ant-layout-content" style="position: relative;"><div class="new-notebook overallContainer"><div class="sessionPane"></div><div class="shell-top new-notebook"><img alt="Loading..." class="load-spinner" src="./nlp - Databricks Community Edition_files/spinner.7eb0071e.svg"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122407"><i class="fa fa-link" style="text-align: center;"></i>Cmd 1</a><div class="new-notebook command mainCommand command-finished cellIndex-0 cell-4396311791122406-4396311791122407"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-0 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-keyword">from</span><span> </span><span class="cm-variable">pyspark</span><span>.</span><span class="cm-property">sql</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">SparkSession</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">spark</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">SparkSession</span><span>.</span><span class="cm-property">builder</span><span>.</span><span class="cm-property">appName</span><span>(</span><span class="cm-string">'nlp'</span><span>)</span><span>.</span><span class="cm-property">getOrCreate</span><span>(</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.04 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:41:33 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122408"><i class="fa fa-link" style="text-align: center;"></i>Cmd 2</a><div class="new-notebook command mainCommand command-finished cellIndex-1 cell-4396311791122406-4396311791122408"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-1 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-keyword">from</span><span> </span><span class="cm-variable">pyspark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">feature</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">Tokenizer</span><span>,</span><span> </span><span class="cm-variable">RegexTokenizer</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-keyword">from</span><span> </span><span class="cm-variable">pyspark</span><span>.</span><span class="cm-property">sql</span><span>.</span><span class="cm-property">functions</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">col</span><span>,</span><span> </span><span class="cm-variable">udf</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-keyword">from</span><span> </span><span class="cm-variable">pyspark</span><span>.</span><span class="cm-property">sql</span><span>.</span><span class="cm-property">types</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">IntegerType</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="spark-advisor-container spark-advisor-collapsed"><img class="spark-advisor-lightbulb" src="./nlp - Databricks Community Edition_files/if_lightbulb.32b79969.svg"><span class="spark-advisor-indicator">1</span></div><div class="command-result-stats"><span>Command took</span> <span>0.12 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:42:08 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122409"><i class="fa fa-link" style="text-align: center;"></i>Cmd 3</a><div class="new-notebook command mainCommand command-finished cellIndex-2 cell-4396311791122406-4396311791122409"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-2 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">sen_df</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">spark</span><span>.</span><span class="cm-property">createDataFrame</span><span>(</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>  </span><span>[</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>    </span><span>(</span><span class="cm-number">0</span><span>,</span><span> </span><span class="cm-string">'Hi I heard about Spark'</span><span>)</span><span>,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span>    </span><span>(</span><span class="cm-number">1</span><span>,</span><span> </span><span class="cm-string">'I wish java could use case classes'</span><span>)</span><span>,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span>    </span><span>(</span><span class="cm-number">2</span><span>,</span><span> </span><span class="cm-string">'Logistic,regression,models,are,neat'</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span>  </span><span>]</span><span>,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span>  </span><span>[</span><span class="cm-string">'id'</span><span>,</span><span> </span><span class="cm-string">'sentence'</span><span>]</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">sen_df:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [id: long, sentence: string]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.36 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:45:05 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122410"><i class="fa fa-link" style="text-align: center;"></i>Cmd 4</a><div class="new-notebook command mainCommand command-finished cellIndex-3 cell-4396311791122406-4396311791122410"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-3 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">sen_df</span><span>.</span><span class="cm-property">show</span><span>(</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(3) Spark Jobs</p></div></div><div class="results"><div class="ansiout">+---+--------------------+
| id|            sentence|
+---+--------------------+
|  0|Hi I heard about ...|
|  1|I wish java could...|
|  2|Logistic,regressi...|
+---+--------------------+

</div></div><div class="command-result-stats"><span>Command took</span> <span>1.24 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:45:05 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122411"><i class="fa fa-link" style="text-align: center;"></i>Cmd 5</a><div class="new-notebook command mainCommand command-finished cellIndex-4 cell-4396311791122406-4396311791122411"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-4 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">tokenizer</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">Tokenizer</span><span>(</span><span class="cm-variable">inputCol</span><span class="cm-operator">=</span><span class="cm-string">'sentence'</span><span>,</span><span> </span><span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">'words'</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">regex_tokenizer</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">RegexTokenizer</span><span>(</span><span class="cm-variable">inputCol</span><span class="cm-operator">=</span><span class="cm-string">'sentence'</span><span>,</span><span> </span><span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">'words'</span><span>,</span><span> </span><span class="cm-variable">pattern</span><span class="cm-operator">=</span><span class="cm-string">'\\W'</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.06 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:46:55 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122412"><i class="fa fa-link" style="text-align: center;"></i>Cmd 6</a><div class="new-notebook command mainCommand command-finished cellIndex-5 cell-4396311791122406-4396311791122412"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-5 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">count_tokens</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">udf</span><span>(</span><span class="cm-keyword">lambda</span><span> </span><span class="cm-variable">words</span><span>:</span><span> </span><span class="cm-builtin">len</span><span>(</span><span class="cm-variable">words</span><span>)</span><span>,</span><span> </span><span class="cm-variable">IntegerType</span><span>(</span><span>)</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.03 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:47:17 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122413"><i class="fa fa-link" style="text-align: center;"></i>Cmd 7</a><div class="new-notebook command mainCommand command-finished cellIndex-6 cell-4396311791122406-4396311791122413"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-6 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">tokenized</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">tokenizer</span><span>.</span><span class="cm-property">transform</span><span>(</span><span class="cm-variable">sen_df</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">tokenized:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [id: long, sentence: string ... 1 more fields]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.20 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:47:32 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122414"><i class="fa fa-link" style="text-align: center;"></i>Cmd 8</a><div class="new-notebook command mainCommand command-finished cellIndex-7 cell-4396311791122406-4396311791122414"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-7 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">tokenized</span><span>.</span><span class="cm-property">show</span><span>(</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(3) Spark Jobs</p></div></div><div class="results"><div class="ansiout">+---+--------------------+--------------------+
| id|            sentence|               words|
+---+--------------------+--------------------+
|  0|Hi I heard about ...|[hi, i, heard, ab...|
|  1|I wish java could...|[i, wish, java, c...|
|  2|Logistic,regressi...|[logistic,regress...|
+---+--------------------+--------------------+

</div></div><div class="command-result-stats"><span>Command took</span> <span>0.53 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:47:36 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122415"><i class="fa fa-link" style="text-align: center;"></i>Cmd 9</a><div class="new-notebook command mainCommand command-finished cellIndex-8 cell-4396311791122406-4396311791122415"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-8 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">tokenized</span><span>.</span><span class="cm-property">withColumn</span><span>(</span><span class="cm-string">'tokens'</span><span>,</span><span> </span><span class="cm-variable">count_tokens</span><span>(</span><span class="cm-variable">col</span><span>(</span><span class="cm-string">'words'</span><span>)</span><span>)</span><span>)</span><span>.</span><span class="cm-property">show</span><span>(</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(3) Spark Jobs</p></div></div><div class="results"><div class="ansiout">+---+--------------------+--------------------+------+
| id|            sentence|               words|tokens|
+---+--------------------+--------------------+------+
|  0|Hi I heard about ...|[hi, i, heard, ab...|     5|
|  1|I wish java could...|[i, wish, java, c...|     7|
|  2|Logistic,regressi...|[logistic,regress...|     1|
+---+--------------------+--------------------+------+

</div></div><div class="command-result-stats"><span>Command took</span> <span>0.87 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:48:29 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122416"><i class="fa fa-link" style="text-align: center;"></i>Cmd 10</a><div class="new-notebook command mainCommand command-finished cellIndex-9 cell-4396311791122406-4396311791122416"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-9 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">rg_tokenized</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">regex_tokenizer</span><span>.</span><span class="cm-property">transform</span><span>(</span><span class="cm-variable">sen_df</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">rg_tokenized:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [id: long, sentence: string ... 1 more fields]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.08 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:49:10 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122417"><i class="fa fa-link" style="text-align: center;"></i>Cmd 11</a><div class="new-notebook command mainCommand command-finished cellIndex-10 cell-4396311791122406-4396311791122417"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-10 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">rg_tokenized</span><span>.</span><span class="cm-property">withColumn</span><span>(</span><span class="cm-string">'token'</span><span>,</span><span> </span><span class="cm-variable">count_tokens</span><span>(</span><span class="cm-variable">col</span><span>(</span><span class="cm-string">'words'</span><span>)</span><span>)</span><span>)</span><span>.</span><span class="cm-property">show</span><span>(</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(3) Spark Jobs</p></div></div><div class="results"><div class="ansiout">+---+--------------------+--------------------+-----+
| id|            sentence|               words|token|
+---+--------------------+--------------------+-----+
|  0|Hi I heard about ...|[hi, i, heard, ab...|    5|
|  1|I wish java could...|[i, wish, java, c...|    7|
|  2|Logistic,regressi...|[logistic, regres...|    5|
+---+--------------------+--------------------+-----+

</div></div><div class="command-result-stats"><span>Command took</span> <span>0.81 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:49:42 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122418"><i class="fa fa-link" style="text-align: center;"></i>Cmd 12</a><div class="new-notebook command mainCommand command-finished cellIndex-11 cell-4396311791122406-4396311791122418"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-11 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-keyword">from</span><span> </span><span class="cm-variable">pyspark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">feature</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">StopWordsRemover</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.07 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:50:48 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122419"><i class="fa fa-link" style="text-align: center;"></i>Cmd 13</a><div class="new-notebook command mainCommand command-finished cellIndex-12 cell-4396311791122406-4396311791122419"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-12 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">sentenceDataFrame</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">spark</span><span>.</span><span class="cm-property">createDataFrame</span><span>(</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>  </span><span>[</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>    </span><span>(</span><span class="cm-number">0</span><span>,</span><span> </span><span>[</span><span class="cm-string">'I'</span><span>,</span><span> </span><span class="cm-string">'saw'</span><span>,</span><span> </span><span class="cm-string">'the'</span><span>,</span><span> </span><span class="cm-string">'green'</span><span>,</span><span> </span><span class="cm-string">'horse'</span><span>]</span><span>)</span><span>,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span>    </span><span>(</span><span class="cm-number">1</span><span>,</span><span> </span><span>[</span><span class="cm-string">'Mary'</span><span>,</span><span> </span><span class="cm-string">'had'</span><span>,</span><span> </span><span class="cm-string">'a'</span><span>,</span><span> </span><span class="cm-string">'little'</span><span>,</span><span> </span><span class="cm-string">'lamb'</span><span>]</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span>  </span><span>]</span><span>,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span>  </span><span>[</span><span class="cm-string">'id'</span><span>,</span><span> </span><span class="cm-string">'tokens'</span><span>]</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">sentenceDataFrame:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [id: long, tokens: array]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.14 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:51:44 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122420"><i class="fa fa-link" style="text-align: center;"></i>Cmd 14</a><div class="new-notebook command mainCommand command-finished cellIndex-13 cell-4396311791122406-4396311791122420"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-13 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">sentenceDataFrame</span><span>.</span><span class="cm-property">show</span><span>(</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(3) Spark Jobs</p></div></div><div class="results"><div class="ansiout">+---+--------------------+
| id|              tokens|
+---+--------------------+
|  0|[I, saw, the, gre...|
|  1|[Mary, had, a, li...|
+---+--------------------+

</div></div><div class="command-result-stats"><span>Command took</span> <span>0.45 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:51:53 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122421"><i class="fa fa-link" style="text-align: center;"></i>Cmd 15</a><div class="new-notebook command mainCommand command-finished cellIndex-14 cell-4396311791122406-4396311791122421"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-14 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">remover</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">StopWordsRemover</span><span>(</span><span class="cm-variable">inputCol</span><span class="cm-operator">=</span><span class="cm-string">'tokens'</span><span>,</span><span> </span><span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">'filtered'</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.17 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:52:27 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122422"><i class="fa fa-link" style="text-align: center;"></i>Cmd 16</a><div class="new-notebook command mainCommand command-finished cellIndex-15 cell-4396311791122406-4396311791122422"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-15 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">remover</span><span>.</span><span class="cm-property">transform</span><span>(</span><span class="cm-variable">sentenceDataFrame</span><span>)</span><span>.</span><span class="cm-property">show</span><span>(</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(3) Spark Jobs</p></div></div><div class="results"><div class="ansiout">+---+--------------------+--------------------+
| id|              tokens|            filtered|
+---+--------------------+--------------------+
|  0|[I, saw, the, gre...| [saw, green, horse]|
|  1|[Mary, had, a, li...|[Mary, little, lamb]|
+---+--------------------+--------------------+

</div></div><div class="command-result-stats"><span>Command took</span> <span>0.67 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:52:49 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122423"><i class="fa fa-link" style="text-align: center;"></i>Cmd 17</a><div class="new-notebook command mainCommand command-finished cellIndex-16 cell-4396311791122406-4396311791122423"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-16 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-keyword">from</span><span> </span><span class="cm-variable">pyspark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">feature</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">NGram</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.05 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:54:13 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122424"><i class="fa fa-link" style="text-align: center;"></i>Cmd 18</a><div class="new-notebook command mainCommand command-finished cellIndex-17 cell-4396311791122406-4396311791122424"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-17 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">wordDataFrame</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">spark</span><span>.</span><span class="cm-property">createDataFrame</span><span>(</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>  </span><span>[</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>    </span><span>(</span><span class="cm-number">0</span><span>,</span><span> </span><span>[</span><span class="cm-string">'Hi'</span><span>,</span><span> </span><span class="cm-string">'I'</span><span>,</span><span> </span><span class="cm-string">'heard'</span><span>,</span><span> </span><span class="cm-string">'about'</span><span>,</span><span> </span><span class="cm-string">'Spark'</span><span>]</span><span>)</span><span>,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span>    </span><span>(</span><span class="cm-number">1</span><span>,</span><span> </span><span>[</span><span class="cm-string">'I'</span><span>,</span><span> </span><span class="cm-string">'wish'</span><span>,</span><span> </span><span class="cm-string">'Java'</span><span>,</span><span> </span><span class="cm-string">'could'</span><span>,</span><span> </span><span class="cm-string">'use'</span><span>,</span><span> </span><span class="cm-string">'case'</span><span>,</span><span> </span><span class="cm-string">'classes'</span><span>]</span><span>)</span><span>,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span>    </span><span>(</span><span class="cm-number">2</span><span>,</span><span> </span><span>[</span><span class="cm-string">'Logistic'</span><span>,</span><span> </span><span class="cm-string">'regression'</span><span>,</span><span> </span><span class="cm-string">'models'</span><span>,</span><span> </span><span class="cm-string">'are'</span><span>,</span><span> </span><span class="cm-string">'neat'</span><span>]</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span>  </span><span>]</span><span>,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span>  </span><span>[</span><span class="cm-string">'id'</span><span>,</span><span> </span><span class="cm-string">'words'</span><span>]</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">wordDataFrame:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [id: long, words: array]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.13 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:55:33 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122425"><i class="fa fa-link" style="text-align: center;"></i>Cmd 19</a><div class="new-notebook command mainCommand command-finished cellIndex-18 cell-4396311791122406-4396311791122425"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-18 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">ngram</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">NGram</span><span>(</span><span class="cm-variable">n</span><span class="cm-operator">=</span><span class="cm-number">2</span><span>,</span><span> </span><span class="cm-variable">inputCol</span><span class="cm-operator">=</span><span class="cm-string">'words'</span><span>,</span><span> </span><span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">'grams'</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">ngram</span><span>.</span><span class="cm-property">transform</span><span>(</span><span class="cm-variable">wordDataFrame</span><span>)</span><span>.</span><span class="cm-property">show</span><span>(</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(3) Spark Jobs</p></div></div><div class="results"><div class="ansiout">+---+--------------------+--------------------+
| id|               words|               grams|
+---+--------------------+--------------------+
|  0|[Hi, I, heard, ab...|[Hi I, I heard, h...|
|  1|[I, wish, Java, c...|[I wish, wish Jav...|
|  2|[Logistic, regres...|[Logistic regress...|
+---+--------------------+--------------------+

</div></div><div class="command-result-stats"><span>Command took</span> <span>0.43 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:56:17 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122426"><i class="fa fa-link" style="text-align: center;"></i>Cmd 20</a><div class="new-notebook command mainCommand command-finished cellIndex-19 cell-4396311791122406-4396311791122426"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-19 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">ngram</span><span>.</span><span class="cm-property">transform</span><span>(</span><span class="cm-variable">wordDataFrame</span><span>)</span><span>.</span><span class="cm-property">select</span><span>(</span><span class="cm-string">'grams'</span><span>)</span><span>.</span><span class="cm-property">show</span><span>(</span><span class="cm-variable">truncate</span><span class="cm-operator">=</span><span class="cm-keyword">False</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(3) Spark Jobs</p></div></div><div class="results"><div class="ansiout">+------------------------------------------------------------------+
|grams                                                             |
+------------------------------------------------------------------+
|[Hi I, I heard, heard about, about Spark]                         |
|[I wish, wish Java, Java could, could use, use case, case classes]|
|[Logistic regression, regression models, models are, are neat]    |
+------------------------------------------------------------------+

</div></div><div class="command-result-stats"><span>Command took</span> <span>0.50 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:56:58 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122427"><i class="fa fa-link" style="text-align: center;"></i>Cmd 21</a><div class="new-notebook command mainCommand command-finished cellIndex-20 cell-4396311791122406-4396311791122427"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-20 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-keyword">from</span><span> </span><span class="cm-variable">pyspark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">feature</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">HashingTF</span><span>,</span><span> </span><span class="cm-variable">IDF</span><span>,</span><span> </span><span class="cm-variable">Tokenizer</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.03 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 4:58:43 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122428"><i class="fa fa-link" style="text-align: center;"></i>Cmd 22</a><div class="new-notebook command mainCommand command-finished cellIndex-21 cell-4396311791122406-4396311791122428"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-21 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">sentenceData</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">spark</span><span>.</span><span class="cm-property">createDataFrame</span><span>(</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>  </span><span>[</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>    </span><span>(</span><span class="cm-number">0.0</span><span>,</span><span> </span><span class="cm-string">'Hi I heard about Spark'</span><span>)</span><span>,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span>    </span><span>(</span><span class="cm-number">0.0</span><span>,</span><span> </span><span class="cm-string">'I wish Java could use case classes'</span><span>)</span><span>,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span>    </span><span>(</span><span class="cm-number">1.0</span><span>,</span><span> </span><span class="cm-string">'Logistic regression models are neat'</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span>  </span><span>]</span><span>,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span>  </span><span>[</span><span class="cm-string">'label'</span><span>,</span><span> </span><span class="cm-string">'sentence'</span><span>]</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">sentenceData:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [label: double, sentence: string]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.12 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:02:30 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122429"><i class="fa fa-link" style="text-align: center;"></i>Cmd 23</a><div class="new-notebook command mainCommand command-finished cellIndex-22 cell-4396311791122406-4396311791122429"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-22 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">sentenceData</span><span>.</span><span class="cm-property">show</span><span>(</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(3) Spark Jobs</p></div></div><div class="results"><div class="ansiout">+-----+--------------------+
|label|            sentence|
+-----+--------------------+
|  0.0|Hi I heard about ...|
|  0.0|I wish Java could...|
|  1.0|Logistic regressi...|
+-----+--------------------+

</div></div><div class="command-result-stats"><span>Command took</span> <span>0.49 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:02:32 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122430"><i class="fa fa-link" style="text-align: center;"></i>Cmd 24</a><div class="new-notebook command mainCommand command-finished cellIndex-23 cell-4396311791122406-4396311791122430"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-23 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">tokenizer</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">Tokenizer</span><span>(</span><span class="cm-variable">inputCol</span><span class="cm-operator">=</span><span class="cm-string">'sentence'</span><span>,</span><span> </span><span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">'words'</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.04 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:02:34 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122431"><i class="fa fa-link" style="text-align: center;"></i>Cmd 25</a><div class="new-notebook command mainCommand command-finished cellIndex-24 cell-4396311791122406-4396311791122431"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-24 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">words_data</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">tokenizer</span><span>.</span><span class="cm-property">transform</span><span>(</span><span class="cm-variable">sentenceData</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">words_data</span><span>.</span><span class="cm-property">show</span><span>(</span><span class="cm-variable">truncate</span><span class="cm-operator">=</span><span class="cm-keyword">False</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(3) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">words_data:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [label: double, sentence: string ... 1 more fields]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout">+-----+-----------------------------------+------------------------------------------+
|label|sentence                           |words                                     |
+-----+-----------------------------------+------------------------------------------+
|0.0  |Hi I heard about Spark             |[hi, i, heard, about, spark]              |
|0.0  |I wish Java could use case classes |[i, wish, java, could, use, case, classes]|
|1.0  |Logistic regression models are neat|[logistic, regression, models, are, neat] |
+-----+-----------------------------------+------------------------------------------+

</div></div><div class="command-result-stats"><span>Command took</span> <span>0.60 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:02:35 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122432"><i class="fa fa-link" style="text-align: center;"></i>Cmd 26</a><div class="new-notebook command mainCommand command-finished cellIndex-25 cell-4396311791122406-4396311791122432"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-25 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">hashing_tf</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">HashingTF</span><span>(</span><span class="cm-variable">inputCol</span><span class="cm-operator">=</span><span class="cm-string">'words'</span><span>,</span><span> </span><span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">'rawFeatures'</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.07 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:03:29 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122433"><i class="fa fa-link" style="text-align: center;"></i>Cmd 27</a><div class="new-notebook command mainCommand command-finished cellIndex-26 cell-4396311791122406-4396311791122433"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-26 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">featurized_data</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">hashing_tf</span><span>.</span><span class="cm-property">transform</span><span>(</span><span class="cm-variable">words_data</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">featurized_data:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [label: double, sentence: string ... 2 more fields]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.09 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:03:46 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122434"><i class="fa fa-link" style="text-align: center;"></i>Cmd 28</a><div class="new-notebook command mainCommand command-finished cellIndex-27 cell-4396311791122406-4396311791122434"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-27 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">idf</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">IDF</span><span>(</span><span class="cm-variable">inputCol</span><span class="cm-operator">=</span><span class="cm-string">'rawFeatures'</span><span>,</span><span> </span><span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">'features'</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.05 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:04:07 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122435"><i class="fa fa-link" style="text-align: center;"></i>Cmd 29</a><div class="new-notebook command mainCommand command-finished cellIndex-28 cell-4396311791122406-4396311791122435"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-28 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">idf_model</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">idf</span><span>.</span><span class="cm-property">fit</span><span>(</span><span class="cm-variable">featurized_data</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(1) Spark Jobs</p></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>1.83 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:04:16 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122436"><i class="fa fa-link" style="text-align: center;"></i>Cmd 30</a><div class="new-notebook command mainCommand command-finished cellIndex-29 cell-4396311791122406-4396311791122436"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-29 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">rescaled_data</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">idf_model</span><span>.</span><span class="cm-property">transform</span><span>(</span><span class="cm-variable">featurized_data</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">rescaled_data:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [label: double, sentence: string ... 3 more fields]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.14 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:05:21 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122437"><i class="fa fa-link" style="text-align: center;"></i>Cmd 31</a><div class="new-notebook command mainCommand command-finished cellIndex-30 cell-4396311791122406-4396311791122437"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-30 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">rescaled_data</span><span>.</span><span class="cm-property">select</span><span>(</span><span class="cm-string">'label'</span><span>,</span><span> </span><span class="cm-string">'features'</span><span>)</span><span>.</span><span class="cm-property">show</span><span>(</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(3) Spark Jobs</p></div></div><div class="results"><div class="ansiout">+-----+--------------------+
|label|            features|
+-----+--------------------+
|  0.0|(262144,[18700,19...|
|  0.0|(262144,[19036,20...|
|  1.0|(262144,[46243,58...|
+-----+--------------------+

</div></div><div class="command-result-stats"><span>Command took</span> <span>0.55 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:05:40 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122438"><i class="fa fa-link" style="text-align: center;"></i>Cmd 32</a><div class="new-notebook command mainCommand command-finished cellIndex-31 cell-4396311791122406-4396311791122438"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-31 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-keyword">from</span><span> </span><span class="cm-variable">pyspark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">feature</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">CountVectorizer</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.03 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:06:20 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122439"><i class="fa fa-link" style="text-align: center;"></i>Cmd 33</a><div class="new-notebook command mainCommand command-finished cellIndex-32 cell-4396311791122406-4396311791122439"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-32 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">df</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">spark</span><span>.</span><span class="cm-property">createDataFrame</span><span>(</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>  </span><span>[</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>    </span><span>(</span><span class="cm-number">0</span><span>,</span><span> </span><span class="cm-string">'a b c'</span><span>.</span><span class="cm-property">split</span><span>(</span><span class="cm-string">' '</span><span>)</span><span>)</span><span>,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span>    </span><span>(</span><span class="cm-number">1</span><span>,</span><span> </span><span class="cm-string">'a b b c a'</span><span>.</span><span class="cm-property">split</span><span>(</span><span class="cm-string">' '</span><span>)</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span>  </span><span>]</span><span>,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span>  </span><span>[</span><span class="cm-string">'id'</span><span>,</span><span> </span><span class="cm-string">'words'</span><span>]</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">df:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [id: long, words: array]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.12 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:07:06 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122440"><i class="fa fa-link" style="text-align: center;"></i>Cmd 34</a><div class="new-notebook command mainCommand command-finished cellIndex-33 cell-4396311791122406-4396311791122440"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-33 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">df</span><span>.</span><span class="cm-property">show</span><span>(</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(3) Spark Jobs</p></div></div><div class="results"><div class="ansiout">+---+---------------+
| id|          words|
+---+---------------+
|  0|      [a, b, c]|
|  1|[a, b, b, c, a]|
+---+---------------+

</div></div><div class="command-result-stats"><span>Command took</span> <span>0.40 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:07:08 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122441"><i class="fa fa-link" style="text-align: center;"></i>Cmd 35</a><div class="new-notebook command mainCommand command-finished cellIndex-34 cell-4396311791122406-4396311791122441"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-34 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">cv</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">CountVectorizer</span><span>(</span><span class="cm-variable">inputCol</span><span class="cm-operator">=</span><span class="cm-string">'words'</span><span>,</span><span> </span><span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">'features'</span><span>,</span><span> </span><span class="cm-variable">vocabSize</span><span class="cm-operator">=</span><span class="cm-number">3</span><span>,</span><span> </span><span class="cm-variable">minDF</span><span class="cm-operator">=</span><span class="cm-number">2.0</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.07 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:08:15 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122442"><i class="fa fa-link" style="text-align: center;"></i>Cmd 36</a><div class="new-notebook command mainCommand command-finished cellIndex-35 cell-4396311791122406-4396311791122442"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-35 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">model</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">cv</span><span>.</span><span class="cm-property">fit</span><span>(</span><span class="cm-variable">df</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(2) Spark Jobs</p></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.81 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:08:25 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122443"><i class="fa fa-link" style="text-align: center;"></i>Cmd 37</a><div class="new-notebook command mainCommand command-finished cellIndex-36 cell-4396311791122406-4396311791122443"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-36 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">result</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">model</span><span>.</span><span class="cm-property">transform</span><span>(</span><span class="cm-variable">df</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">result</span><span>.</span><span class="cm-property">show</span><span>(</span><span class="cm-variable">truncate</span><span class="cm-operator">=</span><span class="cm-keyword">False</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(3) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">result:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [id: long, words: array ... 1 more fields]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout">+---+---------------+-------------------------+
|id |words          |features                 |
+---+---------------+-------------------------+
|0  |[a, b, c]      |(3,[0,1,2],[1.0,1.0,1.0])|
|1  |[a, b, b, c, a]|(3,[0,1,2],[2.0,2.0,1.0])|
+---+---------------+-------------------------+

</div></div><div class="command-result-stats"><span>Command took</span> <span>0.64 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:08:45 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122444"><i class="fa fa-link" style="text-align: center;"></i>Cmd 38</a><div class="new-notebook command mainCommand command-finished cellIndex-37 cell-4396311791122406-4396311791122444"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-37 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-comment"># Code Along</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.03 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:28:35 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122445"><i class="fa fa-link" style="text-align: center;"></i>Cmd 39</a><div class="new-notebook command mainCommand command-finished cellIndex-38 cell-4396311791122406-4396311791122445"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-38 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-monokai"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-keyword">from</span><span> </span><span class="cm-variable">pyspark</span><span>.</span><span class="cm-property">sql</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">SparkSession</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">spark</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">SparkSession</span><span>.</span><span class="cm-property">builder</span><span>.</span><span class="cm-property">appName</span><span>(</span><span class="cm-string">'nlp'</span><span>)</span><span>.</span><span class="cm-property">getOrCreate</span><span>(</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.03 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:29:54 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122446"><i class="fa fa-link" style="text-align: center;"></i>Cmd 40</a><div class="new-notebook command mainCommand command-finished cellIndex-39 cell-4396311791122406-4396311791122446"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-39 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 469.109px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 439.109px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> <span class="cm-operator">=</span> <span class="cm-variable">sqlContext</span>.<span class="cm-property">sql</span>(<span class="cm-string">'SELECT * FROM SMSSpamCollection'</span>)<span class="cm-variable">d</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">df:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [_c0: string, _c1: string]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.20 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:31:26 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122447"><i class="fa fa-link" style="text-align: center;"></i>Cmd 41</a><div class="new-notebook command mainCommand command-finished cellIndex-40 cell-4396311791122406-4396311791122447"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-40 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 211.656px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 181.656px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span>.<span class="cm-property">show</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-variable">truncate</span><span class="cm-operator">=</span><span class="cm-keyword">False</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(1) Spark Jobs</p></div></div><div class="resizable-wrapper ui-resizable" style="height: 400px;"><div class="noscroll-wrapper noscroll" tabindex="-1"><div class="inner"><div class="results"><div class="ansiout">+----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|_c0 |_c1                                                                                                                                                                                                 |
+----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|ham |Go until jurong point, crazy.. Available only in bugis n great world la e buffet... Cine there got amore wat...                                                                                     |
|ham |Ok lar... Joking wif u oni...                                                                                                                                                                       |
|spam|Free entry in 2 a wkly comp to win FA Cup final tkts 21st May 2005. Text FA to 87121 to receive entry question(std txt rate)T&amp;C's apply 08452810075over18's                                         |
|ham |U dun say so early hor... U c already then say...                                                                                                                                                   |
|ham |Nah I don't think he goes to usf, he lives around here though                                                                                                                                       |
|spam|FreeMsg Hey there darling it's been 3 week's now and no word back! I'd like some fun you up for it still? Tb ok! XxX std chgs to send, £1.50 to rcv                                                 |
|ham |Even my brother is not like to speak with me. They treat me like aids patent.                                                                                                                       |
|ham |As per your request 'Melle Melle (Oru Minnaminunginte Nurungu Vettam)' has been set as your callertune for all Callers. Press *9 to copy your friends Callertune                                    |
|spam|WINNER!! As a valued network customer you have been selected to receivea £900 prize reward! To claim call 09061701461. Claim code KL341. Valid 12 hours only.                                       |
|spam|Had your mobile 11 months or more? U R entitled to Update to the latest colour mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030                                          |
|ham |I'm gonna be home soon and i don't want to talk about this stuff anymore tonight, k? I've cried enough today.                                                                                       |
|spam|SIX chances to win CASH! From 100 to 20,000 pounds txt&gt; CSH11 and send to 87575. Cost 150p/day, 6days, 16+ TsandCs apply Reply HL 4 info                                                            |
|spam|URGENT! You have won a 1 week FREE membership in our £100,000 Prize Jackpot! Txt the word: CLAIM to No: 81010 T&amp;C www.dbuk.net LCCLTD POBOX 4403LDNW1A7RW18                                         |
|ham |I've been searching for the right words to thank you for this breather. I promise i wont take your help for granted and will fulfil my promise. You have been wonderful and a blessing at all times.|
|ham |I HAVE A DATE ON SUNDAY WITH WILL!!                                                                                                                                                                 |
|spam|XXXMobileMovieClub: To use your credit, click the WAP link in the next txt message or click here&gt;&gt; http://wap. xxxmobilemovieclub.com?n=QJKGIGHJJGCBL                                               |
|ham |Oh k...i'm watching here:)                                                                                                                                                                          |
|ham |Eh u remember how 2 spell his name... Yes i did. He v naughty make until i v wet.                                                                                                                   |
|ham |Fine if thats the way u feel. Thats the way its gota b                                                                                                                                            |
|spam|England v Macedonia - dont miss the goals/team news. Txt ur national team to 87077 eg ENGLAND to 87077 Try:WALES, SCOTLAND 4txt/ú1.20 POBOXox36504W45WQ 16+                                         |
+----+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
only showing top 20 rows

</div></div></div></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" role="img" aria-label="Resize the output by dragging this handler" style="z-index: 90;"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.24 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:31:40 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122448"><i class="fa fa-link" style="text-align: center;"></i>Cmd 42</a><div class="new-notebook command mainCommand command-finished cellIndex-41 cell-4396311791122406-4396311791122448"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-41 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 94.6562px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 64.6562px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> <span class="cm-operator">=</span> <span class="cm-variable">df</span>.<span class="cm-property">withColumnRenamed</span>(<span class="cm-string">'_c0'</span>, <span class="cm-string">'class'</span>).<span class="cm-property">withColumnRenamed</span>(<span class="cm-string">'_c1'</span>, <span class="cm-string">'text'</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">df:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [class: string, text: string]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.05 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:32:40 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122449"><i class="fa fa-link" style="text-align: center;"></i>Cmd 43</a><div class="new-notebook command mainCommand command-finished cellIndex-42 cell-4396311791122406-4396311791122449"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-42 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 102.438px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 72.4375px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span>.<span class="cm-property">show</span><span class=" CodeMirror-matchingbracket">(</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(1) Spark Jobs</p></div></div><div class="resizable-wrapper ui-resizable" style="height: 400px;"><div class="noscroll-wrapper noscroll" tabindex="-1"><div class="inner"><div class="results"><div class="ansiout">+-----+--------------------+
|class|                text|
+-----+--------------------+
|  ham|Go until jurong p...|
|  ham|Ok lar... Joking ...|
| spam|Free entry in 2 a...|
|  ham|U dun say so earl...|
|  ham|Nah I don't think...|
| spam|FreeMsg Hey there...|
|  ham|Even my brother i...|
|  ham|As per your reque...|
| spam|WINNER!! As a val...|
| spam|Had your mobile 1...|
|  ham|I'm gonna be home...|
| spam|SIX chances to wi...|
| spam|URGENT! You have ...|
|  ham|I've been searchi...|
|  ham|I HAVE A DATE ON ...|
| spam|XXXMobileMovieClu...|
|  ham|Oh k...i'm watchi...|
|  ham|Eh u remember how...|
|  ham|Fine if thats th...|
| spam|England v Macedon...|
+-----+--------------------+
only showing top 20 rows

</div></div></div></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" role="img" aria-label="Resize the output by dragging this handler" style="z-index: 90;"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.39 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:32:45 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122450"><i class="fa fa-link" style="text-align: center;"></i>Cmd 44</a><div class="new-notebook command mainCommand command-finished cellIndex-43 cell-4396311791122406-4396311791122450"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-43 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 352.109px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 322.109px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">sql</span>.<span class="cm-property">functions</span> <span class="cm-keyword">import</span> <span class="cm-variable">length</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.04 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:33:07 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122451"><i class="fa fa-link" style="text-align: center;"></i>Cmd 45</a><div class="new-notebook command mainCommand command-finished cellIndex-44 cell-4396311791122406-4396311791122451"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-44 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 336.531px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 55px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 306.531px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span> <span class="cm-operator">=</span> <span class="cm-variable">df</span>.<span class="cm-property">withColumn</span>(<span class="cm-string">'length'</span>, <span class="cm-variable">length</span>(<span class="cm-variable">df</span><span class=" CodeMirror-matchingbracket">[</span><span class="cm-string">'text'</span><span class=" CodeMirror-matchingbracket">]</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span>.<span class="cm-property">show</span>()</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 55px;"></div><div class="CodeMirror-gutters" style="height: 68px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(1) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">df:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [class: string, text: string ... 1 more fields]</span></a></div><div class="outer-most-struct"></div></div><div class="resizable-wrapper ui-resizable" style="height: 400px;"><div class="noscroll-wrapper noscroll" tabindex="-1"><div class="inner"><div class="results"><div class="ansiout">+-----+--------------------+------+
|class|                text|length|
+-----+--------------------+------+
|  ham|Go until jurong p...|   111|
|  ham|Ok lar... Joking ...|    29|
| spam|Free entry in 2 a...|   155|
|  ham|U dun say so earl...|    49|
|  ham|Nah I don't think...|    61|
| spam|FreeMsg Hey there...|   147|
|  ham|Even my brother i...|    77|
|  ham|As per your reque...|   160|
| spam|WINNER!! As a val...|   157|
| spam|Had your mobile 1...|   154|
|  ham|I'm gonna be home...|   109|
| spam|SIX chances to wi...|   136|
| spam|URGENT! You have ...|   155|
|  ham|I've been searchi...|   196|
|  ham|I HAVE A DATE ON ...|    35|
| spam|XXXMobileMovieClu...|   149|
|  ham|Oh k...i'm watchi...|    26|
|  ham|Eh u remember how...|    81|
|  ham|Fine if thats th...|    56|
| spam|England v Macedon...|   155|
+-----+--------------------+------+
only showing top 20 rows

</div></div></div></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" role="img" aria-label="Resize the output by dragging this handler" style="z-index: 90;"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.34 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:33:30 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122452"><i class="fa fa-link" style="text-align: center;"></i>Cmd 46</a><div class="new-notebook command mainCommand command-finished cellIndex-45 cell-4396311791122406-4396311791122452"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-45 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 289.688px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 259.688px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span>.<span class="cm-property">groupBy</span>(<span class="cm-string">'class'</span>).<span class="cm-property">mean</span>().<span class="cm-property">show</span><span class=" CodeMirror-matchingbracket">(</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(2) Spark Jobs</p></div></div><div class="results"><div class="ansiout">+-----+-----------------+
|class|      avg(length)|
+-----+-----------------+
|  ham| 71.4545266210897|
| spam|138.6706827309237|
+-----+-----------------+

</div></div><div class="command-result-stats"><span>Command took</span> <span>1.45 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:33:46 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122453"><i class="fa fa-link" style="text-align: center;"></i>Cmd 47</a><div class="new-notebook command mainCommand command-finished cellIndex-46 cell-4396311791122406-4396311791122453"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-46 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 796.797px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 766.797px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">feature</span> <span class="cm-keyword">import</span> <span class=" CodeMirror-matchingbracket">(</span><span class="cm-variable">Tokenizer</span>, <span class="cm-variable">StopWordsRemover</span>, <span class="cm-variable">CountVectorizer</span>, <span class="cm-variable">IDF</span>, <span class="cm-variable">StringIndexer</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.04 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:34:56 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122454"><i class="fa fa-link" style="text-align: center;"></i>Cmd 48</a><div class="new-notebook command mainCommand command-finished cellIndex-47 cell-4396311791122406-4396311791122454"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-47 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 88px; left: 586.109px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 112px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like">x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 556.109px; top: 76px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">tokenizer</span> <span class="cm-operator">=</span> <span class="cm-variable">Tokenizer</span>(<span class="cm-variable">inputCol</span><span class="cm-operator">=</span><span class="cm-string">'text'</span>, <span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">'token_text'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">stop_remove</span> <span class="cm-operator">=</span> <span class="cm-variable">StopWordsRemover</span>(<span class="cm-variable">inputCol</span><span class="cm-operator">=</span><span class="cm-string">'token_text'</span>, <span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">'stop_token'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">count_vec</span> <span class="cm-operator">=</span> <span class="cm-variable">CountVectorizer</span>(<span class="cm-variable">inputCol</span><span class="cm-operator">=</span><span class="cm-string">'stop_token'</span>, <span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">'c_vec'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">idf</span> <span class="cm-operator">=</span> <span class="cm-variable">IDF</span>(<span class="cm-variable">inputCol</span><span class="cm-operator">=</span><span class="cm-string">'c_vec'</span>, <span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">'tf_idf'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ham_spam_to_numeric</span> <span class="cm-operator">=</span> <span class="cm-variable">StringIndexer</span>(<span class="cm-variable">inputCol</span><span class="cm-operator">=</span><span class="cm-string">'class'</span>, <span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">'label'</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 112px;"></div><div class="CodeMirror-gutters" style="height: 125px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.17 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:36:37 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122455"><i class="fa fa-link" style="text-align: center;"></i>Cmd 49</a><div class="new-notebook command mainCommand command-finished cellIndex-48 cell-4396311791122406-4396311791122455"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-48 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 398.906px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 368.906px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">feature</span> <span class="cm-keyword">import</span> <span class="cm-variable">VectorAssembler</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.04 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:37:26 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122456"><i class="fa fa-link" style="text-align: center;"></i>Cmd 50</a><div class="new-notebook command mainCommand command-finished cellIndex-49 cell-4396311791122406-4396311791122456"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-49 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 227.234px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 55px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 197.234px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">clean_up</span> <span class="cm-operator">=</span> <span class="cm-variable">VectorAssembler</span>(<span class="cm-variable">inputCols</span><span class="cm-operator">=</span>[<span class="cm-string">'tf_idf'</span>, <span class="cm-string">'length'</span>], </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">'features'</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 55px;"></div><div class="CodeMirror-gutters" style="height: 68px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.05 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:37:34 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122457"><i class="fa fa-link" style="text-align: center;"></i>Cmd 51</a><div class="new-notebook command mainCommand command-finished cellIndex-50 cell-4396311791122406-4396311791122457"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-50 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 414.5px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 384.5px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">classification</span> <span class="cm-keyword">import</span> <span class="cm-variable">NaiveBayes</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.03 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:37:59 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122458"><i class="fa fa-link" style="text-align: center;"></i>Cmd 52</a><div class="new-notebook command mainCommand command-finished cellIndex-51 cell-4396311791122406-4396311791122458"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-51 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 164.859px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 134.859px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">nb</span> <span class="cm-operator">=</span> <span class="cm-variable">NaiveBayes</span><span class=" CodeMirror-matchingbracket">(</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.07 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:38:08 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122459"><i class="fa fa-link" style="text-align: center;"></i>Cmd 53</a><div class="new-notebook command mainCommand command-finished cellIndex-52 cell-4396311791122406-4396311791122459"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-52 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 281.891px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 251.891px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span> <span class="cm-keyword">import</span> <span class="cm-variable">Pipeline</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.02 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:38:16 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122460"><i class="fa fa-link" style="text-align: center;"></i>Cmd 54</a><div class="new-notebook command mainCommand command-finished cellIndex-53 cell-4396311791122406-4396311791122460"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-53 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 31px; left: 110.219px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 55px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 80.2188px; top: 19px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">data_prep_pipe</span> <span class="cm-operator">=</span> <span class="cm-variable">Pipeline</span>(<span class="cm-variable">stages</span><span class="cm-operator">=</span><span class=" CodeMirror-matchingbracket">[</span><span class="cm-variable">ham_spam_to_numeric</span>, <span class="cm-variable">tokenizer</span>, <span class="cm-variable">stop_remove</span>, <span class="cm-variable">count_vec</span>, <span class="cm-variable">idf</span>, <span class="cm-variable">clean_up</span><span class=" CodeMirror-matchingbracket">]</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 55px;"></div><div class="CodeMirror-gutters" style="height: 68px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.04 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:38:58 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122461"><i class="fa fa-link" style="text-align: center;"></i>Cmd 55</a><div class="new-notebook command mainCommand command-finished cellIndex-54 cell-4396311791122406-4396311791122461"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-54 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 31px; left: 297.484px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 55px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 267.484px; top: 19px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">cleaner</span> <span class="cm-operator">=</span> <span class="cm-variable">data_prep_pipe</span>.<span class="cm-property">fit</span>(<span class="cm-variable">df</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">clean_data</span> <span class="cm-operator">=</span> <span class="cm-variable">cleaner</span>.<span class="cm-property">transform</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-variable">df</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 55px;"></div><div class="CodeMirror-gutters" style="height: 68px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(5) Spark Jobs</p></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>5.19 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:39:36 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122462"><i class="fa fa-link" style="text-align: center;"></i>Cmd 56</a><div class="new-notebook command mainCommand command-finished cellIndex-55 cell-4396311791122406-4396311791122462"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-55 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 180.422px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 150.422px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">clean_data</span>.<span class="cm-property">columns</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results" style=""><div class="ansiout">Out[78]: ['class',
 'text',
 'length',
 'label',
 'token_text',
 'stop_token',
 'c_vec',
 'tf_idf',
 'features']</div></div><div class="command-result-stats"><span>Command took</span> <span>0.05 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:40:08 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122463"><i class="fa fa-link" style="text-align: center;"></i>Cmd 57</a><div class="new-notebook command mainCommand command-finished cellIndex-56 cell-4396311791122406-4396311791122463"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-56 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 31px; left: 164.828px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 55px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 134.828px; top: 19px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">clean_data</span> <span class="cm-operator">=</span> <span class="cm-variable">clean_data</span>.<span class="cm-property">select</span>([<span class="cm-string">'label'</span>, <span class="cm-string">'features'</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">clean_data</span>.<span class="cm-property">show</span><span class=" CodeMirror-matchingbracket">(</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 55px;"></div><div class="CodeMirror-gutters" style="height: 68px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(1) Spark Jobs</p></div></div><div class="resizable-wrapper ui-resizable" style="height: 400px;"><div class="noscroll-wrapper noscroll" tabindex="-1"><div class="inner"><div class="results"><div class="ansiout">+-----+--------------------+
|label|            features|
+-----+--------------------+
|  0.0|(13424,[7,11,31,6...|
|  0.0|(13424,[0,24,297,...|
|  1.0|(13424,[2,13,19,3...|
|  0.0|(13424,[0,70,80,1...|
|  0.0|(13424,[36,134,31...|
|  1.0|(13424,[10,60,139...|
|  0.0|(13424,[10,53,103...|
|  0.0|(13424,[125,184,4...|
|  1.0|(13424,[1,47,118,...|
|  1.0|(13424,[0,1,13,27...|
|  0.0|(13424,[18,43,120...|
|  1.0|(13424,[8,17,37,8...|
|  1.0|(13424,[13,30,47,...|
|  0.0|(13424,[39,96,217...|
|  0.0|(13424,[552,1697,...|
|  1.0|(13424,[30,109,11...|
|  0.0|(13424,[82,214,47...|
|  0.0|(13424,[0,2,49,13...|
|  0.0|(13424,[0,74,105,...|
|  1.0|(13424,[4,30,33,5...|
+-----+--------------------+
only showing top 20 rows

</div></div></div></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" role="img" aria-label="Resize the output by dragging this handler" style="z-index: 90;"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.57 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:40:31 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122464"><i class="fa fa-link" style="text-align: center;"></i>Cmd 58</a><div class="new-notebook command mainCommand command-finished cellIndex-57 cell-4396311791122406-4396311791122464"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-57 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 484.734px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 454.734px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">train_data</span>, <span class="cm-variable">test_data</span> <span class="cm-operator">=</span> <span class="cm-variable">clean_data</span>.<span class="cm-property">randomSplit</span>(<span class=" CodeMirror-matchingbracket">[</span><span class="cm-number">0.7</span>, <span class="cm-number">0.3</span><span class=" CodeMirror-matchingbracket">]</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.18 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:40:54 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122465"><i class="fa fa-link" style="text-align: center;"></i>Cmd 59</a><div class="new-notebook command mainCommand command-finished cellIndex-58 cell-4396311791122406-4396311791122465"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-58 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 31px; left: 157.047px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 55px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 127.047px; top: 19px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">spam_detector</span> <span class="cm-operator">=</span> <span class="cm-variable">nb</span>.<span class="cm-property">fit</span>(<span class="cm-variable">train_data</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df</span>.<span class="cm-property">printSchema</span><span class=" CodeMirror-matchingbracket">(</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 55px;"></div><div class="CodeMirror-gutters" style="height: 68px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(2) Spark Jobs</p></div></div><div class="results"><div class="ansiout">root
 |-- class: string (nullable = true)
 |-- text: string (nullable = true)
 |-- length: integer (nullable = true)

</div></div><div class="command-result-stats"><span>Command took</span> <span>3.55 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:41:16 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122466"><i class="fa fa-link" style="text-align: center;"></i>Cmd 60</a><div class="new-notebook command mainCommand command-finished cellIndex-59 cell-4396311791122406-4396311791122466"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-59 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 414.484px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 384.484px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">test_results</span> <span class="cm-operator">=</span> <span class="cm-variable">spam_detector</span>.<span class="cm-property">transform</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-variable">test_data</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.18 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:41:42 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122467"><i class="fa fa-link" style="text-align: center;"></i>Cmd 61</a><div class="new-notebook command mainCommand command-finished cellIndex-60 cell-4396311791122406-4396311791122467"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-60 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 180.438px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 150.438px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">test_results</span>.<span class="cm-property">show</span><span class=" CodeMirror-matchingbracket">(</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(1) Spark Jobs</p></div></div><div class="resizable-wrapper ui-resizable" style="height: 400px;"><div class="noscroll-wrapper noscroll" tabindex="-1"><div class="inner"><div class="results"><div class="ansiout">+-----+--------------------+--------------------+--------------------+----------+
|label|            features|       rawPrediction|         probability|prediction|
+-----+--------------------+--------------------+--------------------+----------+
|  0.0|(13424,[0,1,2,7,8...|[-797.69441959065...|[1.0,7.4590474897...|       0.0|
|  0.0|(13424,[0,1,12,33...|[-440.42363300238...|[1.0,9.1244742968...|       0.0|
|  0.0|(13424,[0,1,17,19...|[-813.88132164764...|[1.0,5.9348029911...|       0.0|
|  0.0|(13424,[0,1,27,88...|[-1536.5865113762...|[1.85607755552601...|       1.0|
|  0.0|(13424,[0,1,31,43...|[-337.91029805740...|[1.0,7.9357719495...|       0.0|
|  0.0|(13424,[0,1,46,17...|[-1139.2205837353...|[4.26299826655520...|       1.0|
|  0.0|(13424,[0,1,498,5...|[-319.82489646931...|[0.99999999999512...|       0.0|
|  0.0|(13424,[0,1,874,1...|[-97.804913734656...|[0.99999997918665...|       0.0|
|  0.0|(13424,[0,2,3,6,9...|[-3303.7500987822...|[1.0,8.7362864317...|       0.0|
|  0.0|(13424,[0,2,3,8,2...|[-1602.1050499905...|[1.0,5.0321078681...|       0.0|
|  0.0|(13424,[0,2,4,5,7...|[-995.50924340736...|[1.0,6.7646641867...|       0.0|
|  0.0|(13424,[0,2,4,5,1...|[-2756.0238968950...|[1.0,4.8485129574...|       0.0|
|  0.0|(13424,[0,2,4,5,1...|[-2756.0238968950...|[1.0,4.8485129574...|       0.0|
|  0.0|(13424,[0,2,4,8,2...|[-554.53658613430...|[1.0,2.8294139905...|       0.0|
|  0.0|(13424,[0,2,4,10,...|[-1220.0445896224...|[1.0,8.1007882372...|       0.0|
|  0.0|(13424,[0,2,4,40,...|[-1581.3475564953...|[0.99963522574430...|       0.0|
|  0.0|(13424,[0,2,5,8,4...|[-827.47811619355...|[1.0,2.2655460992...|       0.0|
|  0.0|(13424,[0,2,7,11,...|[-1349.5287684866...|[1.0,3.3979034885...|       0.0|
|  0.0|(13424,[0,2,7,43,...|[-589.60132873539...|[1.0,1.6391457131...|       0.0|
|  0.0|(13424,[0,2,7,114...|[-458.19131057698...|[1.0,3.2719885606...|       0.0|
+-----+--------------------+--------------------+--------------------+----------+
only showing top 20 rows

</div></div></div></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" role="img" aria-label="Resize the output by dragging this handler" style="z-index: 90;"></div></div><div class="command-result-stats"><span>Command took</span> <span>1.53 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:41:52 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122468"><i class="fa fa-link" style="text-align: center;"></i>Cmd 62</a><div class="new-notebook command mainCommand command-finished cellIndex-61 cell-4396311791122406-4396311791122468"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-61 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 562.703px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 532.703px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">evaluation</span> <span class="cm-keyword">import</span> <span class="cm-variable">MulticlassClassificationEvaluator</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.03 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:42:18 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122469"><i class="fa fa-link" style="text-align: center;"></i>Cmd 63</a><div class="new-notebook command mainCommand command-finished cellIndex-62 cell-4396311791122406-4396311791122469"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-62 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 31px; left: 328.703px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 55px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 298.703px; top: 19px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">acc_eval</span> <span class="cm-operator">=</span> <span class="cm-variable">MulticlassClassificationEvaluator</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">acc</span> <span class="cm-operator">=</span> <span class="cm-variable">acc_eval</span>.<span class="cm-property">evaluate</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-variable">test_results</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 55px;"></div><div class="CodeMirror-gutters" style="height: 68px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(1) Spark Jobs</p></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>2.04 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:42:40 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122470"><i class="fa fa-link" style="text-align: center;"></i>Cmd 64</a><div class="new-notebook command mainCommand command-finished cellIndex-63 cell-4396311791122406-4396311791122470"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-63 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 31px; left: 110.219px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 55px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like">x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 80.2188px; top: 19px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-string">'ACC of NB Model'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-variable">acc</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 55px;"></div><div class="CodeMirror-gutters" style="height: 68px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout">ACC of NB Model
0.9165189459226032
</div></div><div class="command-result-stats"><span>Command took</span> <span>0.03 seconds</span> <span class="command-provenance">-- by e0200783@u.nus.edu</span><span> at 4/1/2021, 5:42:56 PM</span><span title="0401-071419-forge71"> on my-cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper heading-command-wrapper-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406/command/4396311791122471"><i class="fa fa-link" style="text-align: center;"></i>Cmd 65</a><div class="new-notebook command mainCommand command-active command-focused is-editing command-input cellIndex-64 cell-4396311791122406-4396311791122471"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell" role="button"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a class="edit-button edit-button-64 command-button" title="Edit Menu" role="button"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a class="toggle-collapse-button command-button" title="Minimize" role="button"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a class="remove-button command-button" title="Delete" role="button"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt primaryPrompt"><div class="command-text command-text-edit command-text-input"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" style="display: none;"></textarea><div class="CodeMirror cm-s-monokai CodeMirror-wrap CodeMirror-focused"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1" title="CodeMirrorHiddenTextArea"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 10px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div></div></div><div style="clear: both;"></div></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="submit-hint">Shift+Enter to run &nbsp;&nbsp;&nbsp;</div><div class="contentSpacer" style="background: rgb(255, 255, 255); height: 0px;"></div><div style="min-height: 461.5px;"></div></div><div class="notebook-footer"></div></div></main></section><div id="selection-popover" class="hidden add-comment" style="top: 466.5px; right: 50px;"><a class="btn btn-default btn-circle"><i class="fa fa-comment-o fa-fw css-20rwj2" style="text-align: center;"></i></a></div></div></uses-legacy-bootstrap></div></div></div><uses-legacy-bootstrap data-wrapped-element-id="filebrowser-popup"><div id="filebrowser-popup" style="left: -456px; display: none;"><div class="filebrowser-header">Workspace</div><div class="filebrowser filetree" style="width: 532px; display: none;" data-state="invisible" data-history-size="30"><div class="inner"><div class="ft-panel ui-droppable ui-resizable" style="width: 266px;" data-panel="Workspace"><ul class="ft-panel-list"><li class="filetree-list-item top-link has-menu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#" role="button" class="filetree-link" title="Workspace"><i class="fa fa-databricks-does-not-exist fa-fw"></i><span class="filetree-display-name">Workspace</span><div class="dropdown"><i class="fa fa-chevron-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#" role="button" class="filetree-link ui-droppable" title="Shared"><i class="fa fa-share-alt-square fa-fw"></i><span class="filetree-display-name">Shared</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu selected"><a href="https://community.cloud.databricks.com/?o=6274805106266908#" role="button" class="filetree-link ui-droppable" title="Users"><i class="fa fa-users fa-fw"></i><span class="filetree-display-name">Users</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li></ul><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div></div><div class="ft-panel ui-droppable ui-resizable" data-panel="Users" style="width: 0px; background-color: var(--filetree-background-color);"><ul class="ft-panel-list"><li class="filetree-list-item top-link has-menu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#" role="button" class="filetree-link" title="Users"><i class="fa fa-databricks-does-not-exist fa-fw"></i><span class="filetree-display-name">Users</span><div class="dropdown"><i class="fa fa-chevron-down"></i></div></a></li><li class="filetree-list-item home-folder has-menu selected"><a href="https://community.cloud.databricks.com/?o=6274805106266908#" role="button" class="home-folder filetree-link ui-droppable" title="e0200783@u.nus.edu"><i class="fa fa-home fa-fw"></i><span class="filetree-display-name"><span class="email-name">e0200783</span><span class="email-domain">@u.nus.edu</span></span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li></ul><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div></div><div class="ft-panel ui-droppable ui-resizable" data-panel="e0200783@u.nus.edu" style="width: 0px;"><ul class="ft-panel-list"><li class="filetree-list-item top-link has-menu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#" role="button" class="filetree-link" title="e0200783@u.nus.edu"><i class="fa fa-databricks-does-not-exist fa-fw"></i><span class="filetree-display-name">e0200783@u.nus.edu</span><div class="dropdown"><i class="fa fa-chevron-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/2630053361885552" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="ex"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="true"></i><span class="filetree-display-name">ex</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/3931233704032828" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="k_means"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="true"></i><span class="filetree-display-name">k_means</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4188945993011397" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="lin_reg"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="true"></i><span class="filetree-display-name">lin_reg</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/554113705904092" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="log_reg"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="true"></i><span class="filetree-display-name">log_reg</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/115350270000802" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="myfirstnotebook"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="true"></i><span class="filetree-display-name">myfirstnotebook</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu selected"><a href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122406" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="nlp"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="true"></i><span class="filetree-display-name">nlp</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/293136919831567" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="random_forest"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="false"></i><span class="filetree-display-name">random_forest</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/4396311791122392" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="recommend"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="true"></i><span class="filetree-display-name">recommend</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/2521805719397858" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="spark_dates"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="true"></i><span class="filetree-display-name">spark_dates</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/3210813475419679" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="spark_df_exercise"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="false"></i><span class="filetree-display-name">spark_df_exercise</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/2521805719397767" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="spark_filtering"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="true"></i><span class="filetree-display-name">spark_filtering</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/2521805719397793" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="spark_groupby"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="true"></i><span class="filetree-display-name">spark_groupby</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#notebook/2521805719397830" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="spark_missing"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="true"></i><span class="filetree-display-name">spark_missing</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li></ul><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div></div></div></div><a class="ft-pin-button" href="https://community.cloud.databricks.com/?o=6274805106266908#" title="Pin side panels"></a><a class="ft-scroll-angle-left" href="https://community.cloud.databricks.com/?o=6274805106266908#" title="Scroll to left"><i class="fa fa-angle-left"></i></a><a class="ft-scroll-angle-right hidden" href="https://community.cloud.databricks.com/?o=6274805106266908#" title="Scroll to right"><i class="fa fa-angle-right"></i></a></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="projects-filebrowser-popup"><div id="projects-filebrowser-popup" style="display: none;"><div class="filebrowser-header">Projects <a class="btn btn-secondary create-project">Create Project</a></div><div class="filebrowser" style="display: none;"></div></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="searchpanel-popup"><div id="searchpanel-popup"><div class="searchpanel ui-resizable" data-panel="Search" style="display: none;" data-state="invisible"><div class="search-panel-content"><a class="ft-pin-button" title="Pin side panels"></a><div class="newsearch"><input title="Search Workspace" class="newsearch searchbox" type="text" placeholder="Search Workspace" aria-label="Search Workspace"><span class="search-mixin-spinner"><i class="fa fa-spinner fa-spin" style="text-align: center;"></i></span></div><ul aria-live="polite"></ul></div><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div></div></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="title-menu"><div id="title-menu" class="tb-title-menu dropdown-menu" role="menu"></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="user-menu"><div id="user-menu" class="dropdown-menu"><div class="user-menu-view"><div class="account-section"><div class="header" title="e0200783@u.nus.edu">Signed in as <br><b>e0200783@u.nus.edu</b></div><ul><li><a href="https://community.cloud.databricks.com/?o=6274805106266908#setting/account" class="accounts-link settings-button"><div class="accounts-text">User Settings</div></a></li><li><a href="https://community.cloud.databricks.com/?o=6274805106266908#setting/accounts" class="accounts-link admin-console-button"><div class="accounts-text">Admin Console</div></a></li><li><a href="https://accounts.cloud.databricks.com/login" class="accounts-link manage-account-button"><div class="accounts-text">Manage Account</div></a></li><li><a href="https://community.cloud.databricks.com/?o=6274805106266908#setting/logout" class="accounts-link logout-button"><div class="accounts-text">Log Out</div></a></li></ul></div><hr><div><div class="org-section"><div class="header">Workspaces</div><ul class="confirmed-workspaces"><li><a class="workspace-link" data-name="NUS" target="_blank" title="NUS (e0200783@u.nus.edu)"><div class="workspace-item"><div class="workspace-text"><div class="icon"><i class="fa fa-check" style="text-align: center;"></i></div><div class="workspace-name">NUS</div></div><div class="workspace-owner">e0200783@u.nus.edu</div></div></a></li></ul></div></div></div></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="dropdown-menu"><ul id="help-menu" class="dropdown-menu newhelp"><div><div class="input"><i class="fa fa-search fa-fw" style="text-align: center;"></i><input title="Search" class="newsearch" type="text" placeholder="Search" aria-label="Search"><span class="search-mixin-spinner"><i class="fa fa-spinner fa-spin" style="text-align: center;"></i></span></div><ul aria-live="polite" style="max-height: 753px;"><li class="result" aria-atomic="true"><a href="https://help.databricks.com/" class="" title="Help Center"><i class="fa fa- fa-fw"></i><span>Help Center</span></a></li><li class="result" aria-atomic="true"><a href="https://docs.databricks.com/release-notes/" class="" title="Release Notes"><i class="fa fa- fa-fw"></i><span>Release Notes</span></a></li><li class="result" aria-atomic="true"><a href="https://docs.databricks.com/" class="" title="Documentation"><i class="fa fa- fa-fw"></i><span>Documentation</span></a></li><li class="result" aria-atomic="true"><a href="https://kb.databricks.com/" class="" title="Knowledge Base"><i class="fa fa- fa-fw"></i><span>Knowledge Base</span></a></li><li class="result" aria-atomic="true"><a href="mailto:feedback@databricks.com" class="" title="Feedback"><i class="fa fa- fa-fw"></i><span>Feedback</span></a></li><li class="result" aria-atomic="true"><a href="https://community.cloud.databricks.com/SHORTCUT_URL" class="" title="Shortcuts"><i class="fa fa- fa-fw"></i><span>Shortcuts</span></a></li></ul></div></ul></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="hidden"><div id="hidden" style="display: none;"></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="history"><div id="history" style="display: none;"><div id="history-head">
  
  <h3 class="history-title">
    Recent Activity
    <i class="hide-recent-activity remove-button fa fa-remove fa-fw"></i>
  </h3>
  
</div>

<div id="history-list">
  <ul>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:42:53</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Added a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:42:53</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:42:40</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Added a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:42:39</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:42:16</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Added a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:42:16</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:41:50</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Added a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:41:50</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:41:41</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:41:33</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Added a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:41:33</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:41:13</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Added a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:41:13</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:40:53</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Added a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:40:53</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:40:31</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:40:16</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Added a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:40:16</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:40:06</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        E
      </div>
      <div class="history-item-action">
        <p class="user-name">e0200783@u.nus.edu:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-04-01 17:39:50</p>
      </div>
    </li>
    
  </ul>
</div>
</div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="proxy-endpoints-conn-test-iframe"><div id="proxy-endpoints-conn-test-iframe" style="display: none;"><iframe src="./nlp - Databricks Community Edition_files/proxy-endpoints-domain-conn-test.html" height="0" width="0" tabindex="-1" title="empty" class="hidden"></iframe></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="debugHelper"><div id="debugHelper" style="z-index: 1000; display: none; position: fixed; right: 190px; bottom: 0px;"><div id="debugRoute" style="position: fixed; right: 190px; bottom: 40px;"></div><div id="debugCounters" style="color:var(--primary-text-color); position: fixed; right: 50px; bottom: 20px;"></div><a href="https://community.cloud.databricks.com/ops/">[OPS]</a> <a href="https://community.cloud.databricks.com/ops/debug">Debug</a> <a href="https://community.cloud.databricks.com/ops/metrics">Metrics</a> <a href="https://community.cloud.databricks.com/ops/requests">Requests</a></div></uses-legacy-bootstrap><script type="text/javascript" async="" src="./nlp - Databricks Community Edition_files/heap-3428506230.js.download"></script><script src="./nlp - Databricks Community Edition_files/metrics-graphics.e5fc3608.js.download"></script><script src="./nlp - Databricks Community Edition_files/main.2106161c.js.download"></script><uses-legacy-bootstrap><div class="filebrowser-context-menu dropdown-menu active" style="display: none; left: 562px; top: 81px;" data-id="115350270000796" role="menu"><li class="dropdown-submenu"><ul class="dropdown-menu"><li><a href="https://community.cloud.databricks.com/?o=6274805106266908#" data-name="Notebook">Notebook</a></li><li><a href="https://community.cloud.databricks.com/?o=6274805106266908#" data-name="Library">Library</a></li><li><a href="https://community.cloud.databricks.com/?o=6274805106266908#" data-name="Folder">Folder</a></li><li><a href="https://community.cloud.databricks.com/?o=6274805106266908#" data-name="MLflow Experiment">MLflow Experiment</a></li></ul><a href="https://community.cloud.databricks.com/?o=6274805106266908#" data-name="Create">Create</a></li><li><a href="https://community.cloud.databricks.com/?o=6274805106266908#" data-name="Clone">Clone</a></li><li><a href="https://community.cloud.databricks.com/?o=6274805106266908#" data-name="Import">Import</a></li><li class="dropdown-submenu"><a href="https://community.cloud.databricks.com/?o=6274805106266908#" data-name="Export">Export</a><ul class="dropdown-menu"><li><a href="https://community.cloud.databricks.com/?o=6274805106266908#" data-name="DBC Archive">DBC Archive</a></li><li><a href="https://community.cloud.databricks.com/?o=6274805106266908#" data-name="HTML">HTML</a></li></ul></li><li><a href="https://community.cloud.databricks.com/?o=6274805106266908#" data-name="Permissions" disabled="true">Permissions</a></li><li><a href="https://community.cloud.databricks.com/?o=6274805106266908#" data-name="Copy Link Address">Copy Link Address</a></li></div></uses-legacy-bootstrap><input type="file" multiple="multiple" class="dz-hidden-input" style="visibility: hidden; position: absolute; top: 0px; left: 0px; height: 0px; width: 0px;"><input type="file" multiple="multiple" class="dz-hidden-input" style="visibility: hidden; position: absolute; top: 0px; left: 0px; height: 0px; width: 0px;"><uses-legacy-bootstrap>
        
      </uses-legacy-bootstrap><input type="file" multiple="multiple" class="dz-hidden-input" style="visibility: hidden; position: absolute; top: 0px; left: 0px; height: 0px; width: 0px;"><div class="ReactModalPortal"></div><div class="ReactModalPortal"></div></body></html>